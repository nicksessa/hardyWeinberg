<!DOCTYPE html>
<html>

<head>
    <title>Hardy-Weinberg Equation</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

    <!-- Import Custom Font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=IM Fell English SC">

    <style>

    </style>
</head>

<body>
    <div class="container py-5">
        <div class="row">
            <div class="col-md-12">
                <h2 class="text-center mb-5">Hardy-Weinberg Equation</h2>
                <ul class="nav nav-fill">
                    <a class="nav-item" href="#findq">Find q</a>
                    <!--                     <a class="nav-item" href="#formChangePassword">Password</a>
                    <a class="nav-item" href="#formContact">Contact</a> -->
                </ul>
                <hr class="mb-5">
                <div class="row">

                    <div class="col-md-8 offset-md-2">
                        <span>p + q = 1</span>
                        <div>
                            <span>p<sup>2</sup> + 2pq + q<sup>2</sup> = 1</span>
                        </div>
                        <span class="anchor" id="findq"></span>
                        <hr class="mb-5">

                        <!-- form card register -->
                        <div class="card card-outline-secondary">
                            <div class="card-header">
                                <h3 class="mb-0">Find q</h3>
                            </div>
                            <div class="card-body">
                                <form class="form" role="form" autocomplete="off" id="mainForm" >
                                    <div class="form-group row">
                                        <label class="col-lg-9 col-form-label form-control-label">Total # of Individuals
                                            in a Population</label>
                                        <div class="col-lg-3">
                                            <input id="populationSize" class="form-control" type="number" value="100"
                                                required="">
                                        </div>
                                    </div>
                                    <div class="form-group row">
                                        <label class="col-lg-9 col-form-label form-control-label"># of Individuals with
                                            recessive Allele</label>
                                        <div class="col-lg-3">
                                            <input id="recessiveAllele" class="form-control" type="number" value="20"
                                                required="">
                                        </div>
                                    </div>

                                    <div class="form-group row">
                                        <div class="col-lg-3 offset-lg-9">
                                            <button id="submitBtn" type="submit"
                                                class="btn btn-success btn-lg float-right">Submit</button>
                                        </div>
                                    </div>

                                    <hr>
                                    <div class="form-group row">
                                        <div class="col">
                                            <p>
                                                <h4>Results:</h4>
                                            </p>
                                        </div>
                                    </div>
                                    <div id="resultsForQ"></div>


                                </form>
                            </div>
                        </div>
                        <!-- /form find q -->

                    </div>
                    <div class="col-md-8 offset-md-2">
                        <span class="anchor" id="genotypicFrequencies"></span>
                        <hr class="mb-5">

                        <!-- form card genotype frequencies -->
                        <div class="card card-outline-secondary">
                            <div class="card-header">
                                <h3 class="mb-0">Genotypic Frequencies</h3>
                            </div>
                            <div class="card-body">
                                <form class="form" role="form" autocomplete="off">

                                    <table class="table">
                                        <thead>
                                            <tr>
                                                <th>Genotype</th>
                                                <th>Phenotype</th>
                                                <th>Formula</th>
                                                <th>Result</th>
                                                <th>Num Individuals</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>AA</td>
                                                <td>homozygous dominant</td>
                                                <td>p<sup>2</sup></td>
                                                <td id="AA_freq"></td>
                                                <td id="AA_num"></td>
                                            </tr>
                                            <tr>
                                                <td>Aa</td>
                                                <td>heterozygous</td>
                                                <td>2pq</td>
                                                <td id="Aa_freq"></td>
                                                <td id="Aa_num"></td>
                                            </tr>
                                            <tr>
                                                <td>aa</td>
                                                <td>homozygous recessive</td>
                                                <td>q<sup>2</sup></td>
                                                <td id="aa_freq"></td>
                                                <td id="aa_num"></td>
                                            </tr>
                                        </tbody>
                                    </table>


                                </form>
                            </div>
                        </div>
                        <!-- /form card genotypes -->

                    </div>

                </div>
                <!--/row-->

                <br><br><br><br>

            </div>
            <!--/col-->
        </div>
        <!--/row-->
        <hr>
        <p class="text-center">The End.<br>
            <!-- <a class="small text-info d-inline-block" href="https://www.codeply.com/bootstrap-4-examples">More Bootstrap 4 Examples</a> -->
        </p>

    </div>
    <!--/container-->
    <script>

        // validation example for Login form
        $("#submitBtn").click(function (event) {

            var x = $("#populationSize").val()
            var y = $("#recessiveAllele").val()

            //console.log("x is: " + x)
            //console.log("y is: " + y)

            if (x == null || y == null || x == "" || y == "") {

            } else {
                run()
            }



            /* var form = $("#mainForm");

            if (form[0].checkValidity() === false) {
                event.preventDefault();
                event.stopPropagation();
            } else {
                run()
            } */

            // if validation passed form
            // would post to the server here

            //form.addClass('was-validated');

            
        });

        function run() {
            //$("#submitBtn").click(function (event) {
                //alert("btn clicked!")
                var totalPop = parseInt($("#populationSize").val())
                var numRecessive = parseInt($("#recessiveAllele").val())
                var percentRecessive = numRecessive / totalPop

                var q = Math.sqrt(parseFloat(percentRecessive))
                q = q.toPrecision(2)
                var p = 1 - q
                p = p.toPrecision(2)

                // calculate genotypic frequencies

                var A = p
                var a = q

                var AA = A * A
                AA = AA.toPrecision(2)
                var Aa = (A * a) * 2
                Aa = Aa.toPrecision(2)
                var aa = a * a
                aa = aa.toPrecision(2)

                // calculate the number of individuals for each genotype
                var numAA = AA * totalPop
                var numAa = Aa * totalPop
                var numaa = aa * totalPop


                var myString = ""
                myString = `<p>Percent of the population that is recessive is: ${percentRecessive}  This is also the phenotype frequency which confusingly is also the genotypic frequency.</p>`
                myString += `<p>Therefore, q<sup>2</sup> = ${percentRecessive}</p>`
                myString += `<p>The sqrt of q<sup>2</sup> is: q</p>`
                myString += `<p>The sqrt of ${percentRecessive} is: ${q}</p>`
                myString += `<p>Therefore, q = ${q}</p><hr>`
                myString += `<p>Hardy-Weinberg Formula: p + q = 1</p>`
                myString += `<p>Solve for p:</p>`
                myString += `<p>p + ${q} = 1</p>`
                myString += `<p>p = ${p}</p>`
                myString += `<p>${p} + ${q} = 1</p><hr>`
                myString += `<p>Therefore, the frequency of the 'a' allele in in the population is q = ${q} and the frequency of the 'A' allele in the population is p = ${p}</p>`
                $("#resultsForQ").html(myString)


                $("#AA_freq").html(AA)
                $("#AA_num").html(numAA)

                $("#Aa_freq").html(Aa)
                $("#Aa_num").html(numAa)

                $("#aa_freq").html(aa)
                $("#aa_num").html(numaa)

            //});
        }


    </script>
</body>

</html>
